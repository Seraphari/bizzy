<div class="container" data-controller="search-investors">
  <div class="row d-flex justify-content-end my-3">
    <div class="col-md-4">
      <%= form_with url: investors_path, method: :get, html: {class:
          "d-flex w-80", data: {search_investors_target: "form"}} do %>
      <%= text_field_tag :query,
        params[:query],
        class: "form-control",
        placeholder: "Find an investor",
        data: {
          search_investors_target: "input",}
      %>
      <%= submit_tag "Search", class: "btn btn-outline-primary" %>
      <% end %>
    </div>
    <% if params[:query].present? %>
      <p><%= Investor.search_by_company_name_and_company_description(params[:query]).count %>
      <%= Investor.search_by_company_name_and_company_description(params[:query]).count > 1 ? "results" : "result" %> for
      "<%= params[:query] %>"
      </p>
    <% end %>
  </div>

  <div class="row row-cols-1 row-cols-md-3 g-20" data-search-investors-target="list">
  <% @investors.each do |investor| %>
    <div class="col-sm-4 g-4">
      <div class="card h-100 p-3 mb-2">
        <div class="card-body d-grid gap-2" data-controller="favorite">
          <%= link_to favorite_investor_path(investor), data: {turbo_method: :post, action: "click->favorite#update"} do %>
            <i class="fa-bookmark d-grid gap-2 d-md-flex justify-content-md-end <%= current_user.favorited?(investor) ? "fa-solid" : "fa-regular" %>" data-favorite-target="bookmark"></i>
          <% end %>
          <% if investor.photo.key.nil? %>
            <img src="https://images.pexels.com/photos/209620/pexels-photo-209620.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1" alt="">
          <% else %>
            <%= cl_image_tag investor.photo.key, height: 300, width: 530, crop: :fill %>
          <% end %>
          <h5 class="card-title"><strong><%= investor.company_name %></strong></h5>
          <p class="card-text"><%= investor.company_description %></p>
          <%# <p class="card-text text-warning">
          <% investor.sectors.take(1).each do |sector| %>
            <%# <strong><%= sector.name %>
          <div class="card-bottom flex text-center">
            <a href= <%= "/investors/#{investor.id}" %> class="btn btn-primary">Know more</a>
            <a href= <%= "/investors/#{investor.id}/edit" %> class="btn btn-primary">Edit</a>
          </div>
        </div>
      </div>
    </div>
  <% end %>
  </div>
</div>

<%# <%= pagy_nav(@pagy) %>
